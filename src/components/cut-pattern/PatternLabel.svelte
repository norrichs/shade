<script lang="ts">
	import { svgPathStringFromSegments } from '$lib/patterns/flower-of-life';
	import { getPointsInsetFromPoints } from '$lib/patterns/utils';
	import {
		isArcPathSegment,
		isCubicBezierPathSegment,
		isLinePathSegment,
		isMovePathSegment,
		isQuadraticBezierPathSegment,
		type PathSegment,
		type Point
	} from '$lib/types';
	import AllControls from '../controls/AllControls.svelte';
	import { numberPathSegments } from './number-path-segments';

	export let value: number;
	// export let target: string = '';
	// export let scale: number = 1;

	let width = 30;
	let height = 30;
	let radius = 5;
	let textHeight = 20;

	const numberPathStrings: { [key: string]: string } = {
		0: 'M 17.706 69.885 A 27.804 27.804 0 0 0 28.451 71.902 A 34.414 34.414 0 0 0 30.002 71.867 A 26.03 26.03 0 0 0 48.951 63.052 A 26.662 26.662 0 0 0 53.781 55.15 Q 56.901 47.441 56.901 36.102 Q 56.901 25.779 54.364 18.416 A 28.232 28.232 0 0 0 49.101 9.002 A 25.17 25.17 0 0 0 38.627 1.664 A 28.826 28.826 0 0 0 28.651 0.002 Q 16.001 0.002 8.001 9.052 Q 0.001 18.102 0.001 35.802 A 67.56 67.56 0 0 0 0.364 42.976 Q 0.93 48.27 2.379 52.619 A 29.45 29.45 0 0 0 7.951 62.702 A 25.952 25.952 0 0 0 17.706 69.885 Z M 28.451 19.202 A 6.451 6.451 0 0 0 24.011 20.987 Q 23.111 21.801 22.314 22.985 A 14.845 14.845 0 0 0 21.951 23.552 A 15.609 15.609 0 0 0 20.31 27.417 Q 19.301 30.964 19.301 35.902 A 40.334 40.334 0 0 0 19.538 40.429 Q 20.076 45.177 21.836 48.127 A 11.958 11.958 0 0 0 21.851 48.152 A 11.035 11.035 0 0 0 23.497 50.301 A 6.787 6.787 0 0 0 28.451 52.402 A 6.801 6.801 0 0 0 33.591 50.083 A 11.437 11.437 0 0 0 35.051 48.102 Q 37.601 43.802 37.601 35.802 Q 37.601 30.74 36.54 27.16 A 15.139 15.139 0 0 0 34.951 23.502 A 12.144 12.144 0 0 0 33.365 21.423 Q 32.229 20.247 30.919 19.694 A 6.277 6.277 0 0 0 28.451 19.202 Z',
		1: 'M 34.1 2.6 L 34.1 68.3 A 0.86 0.86 0 0 1 33.543 69.004 Q 31.957 69.871 25.865 69.983 A 103.983 103.983 0 0 1 23.95 70 A 94.822 94.822 0 0 1 21.026 69.959 Q 13.8 69.734 13.8 68.3 L 13.8 19 L 3 19.1 A 1.828 1.828 0 0 1 2.896 19.097 Q 0.383 18.953 0.051 11.831 A 50.219 50.219 0 0 1 0 9.5 Q 0 6.2 0.65 3.1 A 9.708 9.708 0 0 1 0.947 1.988 Q 1.619 0 2.9 0 L 30.3 0 A 6.299 6.299 0 0 1 31.438 0.097 Q 32.377 0.27 33.05 0.75 A 2.946 2.946 0 0 1 33.626 1.28 A 2.032 2.032 0 0 1 34.1 2.6 Z',
		2: 'M 39 71.102 L 5.8 71.102 A 3.451 3.451 0 0 1 3.079 69.73 Q 1.985 68.422 1.275 65.868 A 23.749 23.749 0 0 1 0.9 64.302 A 65.994 65.994 0 0 1 0.594 62.565 Q 0.3 60.746 0.225 59.491 A 13.365 13.365 0 0 1 0.2 58.702 Q 0.2 57.318 0.519 56.624 A 1.435 1.435 0 0 1 0.8 56.202 A 282.056 282.056 0 0 0 8.413 48.06 Q 23.2 31.546 23.2 24.802 A 8.601 8.601 0 0 0 23.062 23.208 Q 22.753 21.57 21.75 20.602 A 4.358 4.358 0 0 0 20.224 19.67 Q 19.558 19.422 18.733 19.305 A 11.357 11.357 0 0 0 17.15 19.202 A 17.4 17.4 0 0 0 11.441 20.188 A 19.915 19.915 0 0 0 10.85 20.402 Q 8.604 21.258 7.045 22.215 A 12.594 12.594 0 0 0 5.9 23.002 Q 2 18.302 0.5 13.102 A 13.147 13.147 0 0 1 0.133 11.514 A 9.696 9.696 0 0 1 0 9.952 Q 0 8.502 0.5 7.202 A 3.674 3.674 0 0 1 1.451 5.724 Q 3.055 4.106 7.083 2.613 A 41.684 41.684 0 0 1 7.95 2.302 Q 14.6 0.002 22 0.002 A 36.713 36.713 0 0 1 30.453 0.888 Q 41.872 3.6 43.942 14.617 A 28.649 28.649 0 0 1 44.4 19.902 Q 44.4 28.702 38.4 37.752 Q 32.4 46.802 24.4 53.402 L 44.6 52.602 A 132.306 132.306 0 0 1 44.905 56.381 Q 45.1 59.365 45.1 61.802 A 15.874 15.874 0 0 1 44.836 64.773 Q 44.476 66.665 43.624 68.188 A 9.953 9.953 0 0 1 43.5 68.402 A 6.196 6.196 0 0 1 42.278 69.912 A 4.789 4.789 0 0 1 39 71.102 Z',
		3: 'M 17.3 42.901 L 13.7 42.901 Q 12.5 42.901 11.45 39.951 Q 10.4 37.001 10.4 34.201 A 11.874 11.874 0 0 1 10.498 32.6 Q 10.925 29.482 13.2 29.401 L 16.1 29.301 A 10.593 10.593 0 0 0 19.217 28.81 Q 20.459 28.429 21.75 27.751 Q 23.475 26.844 24.191 25.647 A 3.532 3.532 0 0 0 24.7 23.801 A 3.459 3.459 0 0 0 22.521 20.493 Q 20.935 19.734 18.197 19.62 A 24.122 24.122 0 0 0 17.2 19.601 Q 11.6 19.601 6.4 21.801 A 62.264 62.264 0 0 1 4.431 17.972 Q 2.627 14.116 2.109 11.275 A 11.892 11.892 0 0 1 1.9 9.151 Q 1.9 5.294 6.463 3.054 A 17.853 17.853 0 0 1 8.25 2.301 Q 13.186 0.513 20.086 0.115 A 71.486 71.486 0 0 1 24.2 0.001 A 37.163 37.163 0 0 1 30.048 0.431 Q 35.572 1.313 39.2 4.001 A 12.657 12.657 0 0 1 44.51 13.17 A 16.313 16.313 0 0 1 44.6 14.901 A 22.262 22.262 0 0 1 42.825 23.942 Q 40.304 29.686 34.2 33.501 A 24.964 24.964 0 0 1 40.361 36.986 A 16.678 16.678 0 0 1 46.8 50.801 A 21.875 21.875 0 0 1 45.608 58.167 A 18.862 18.862 0 0 1 40.1 66.151 A 21.775 21.775 0 0 1 32.249 70.445 Q 29.031 71.466 25.149 71.817 A 47.233 47.233 0 0 1 20.9 72.001 A 48.164 48.164 0 0 1 12.455 71.289 A 39.139 39.139 0 0 1 6.5 69.751 A 24.663 24.663 0 0 1 4.128 68.801 Q 1.823 67.724 0.806 66.478 A 3.238 3.238 0 0 1 0 64.401 A 13.517 13.517 0 0 1 0.268 61.807 Q 0.612 60.047 1.4 58.051 A 57.443 57.443 0 0 1 2.351 55.775 Q 2.799 54.768 3.236 53.912 A 25.034 25.034 0 0 1 4.1 52.351 A 61.223 61.223 0 0 1 4.408 51.847 Q 5.399 50.242 5.591 50.202 A 0.045 0.045 0 0 1 5.6 50.201 A 23.842 23.842 0 0 0 14.247 53.424 A 22.732 22.732 0 0 0 17.8 53.701 Q 20.816 53.701 22.95 52.791 A 8.371 8.371 0 0 0 24.25 52.101 Q 26.606 50.562 26.696 47.867 A 6.469 6.469 0 0 0 26.7 47.651 Q 26.7 44.916 24.628 44.068 A 4.098 4.098 0 0 0 24.45 44.001 A 12.397 12.397 0 0 0 22.975 43.59 Q 20.822 43.116 17.3 42.901 Z',
		4: 'M 47.1 40.6 L 53.7 40.6 A 0.493 0.493 0 0 1 54.088 40.958 Q 54.7 42.244 54.7 48.15 A 89.179 89.179 0 0 1 54.676 50.325 Q 54.573 54.527 54.034 55.444 A 0.416 0.416 0 0 1 53.7 55.7 L 47.1 55.8 L 47.1 68.4 A 0.739 0.739 0 0 1 46.776 68.971 Q 45.947 69.641 43 70 A 79.948 79.948 0 0 1 40.08 70.305 Q 37.775 70.5 35.9 70.5 L 31.8 70.3 Q 28.13 70.012 27.101 69.206 A 0.895 0.895 0 0 1 26.7 68.5 L 26.7 56.1 L 6.8 56.1 Q 4.363 53.663 2.365 49.863 A 36.883 36.883 0 0 1 2.1 49.35 Q 0.055 45.309 0.002 43.449 A 3.423 3.423 0 0 1 0 43.35 A 9.278 9.278 0 0 1 0.068 42.192 Q 0.141 41.611 0.293 41.13 A 4.11 4.11 0 0 1 0.6 40.4 L 22.5 1.6 A 0.813 0.813 0 0 1 22.895 1.286 Q 24.091 0.717 28.65 0.4 Q 34.4 0 40.7 0 A 130.677 130.677 0 0 1 42.177 0.008 Q 47 0.063 47 0.5 L 47.1 40.6 Z M 17.9 40.7 L 29.6 40.7 L 29.6 19.8 L 17.9 40.7 Z',
		5: 'M 5.9 0 L 38.3 0 Q 40.2 0 40.2 8.3 A 36.672 36.672 0 0 1 40.137 10.384 Q 40.071 11.538 39.936 12.838 A 70.884 70.884 0 0 1 39.75 14.45 Q 39.3 18 38.1 18 L 18.6 18 L 18.5 25.3 L 21.8 25.3 A 29.256 29.256 0 0 1 27.955 25.905 Q 31.724 26.717 34.537 28.617 A 15.725 15.725 0 0 1 37.75 31.5 A 21.389 21.389 0 0 1 42.191 40.508 Q 43 43.896 43 47.9 A 23.498 23.498 0 0 1 41.547 56.307 A 20.971 20.971 0 0 1 35.8 64.55 A 24.893 24.893 0 0 1 23.014 70.545 A 34.51 34.51 0 0 1 17.3 71 Q 6 71 0.8 67.8 Q 0 66.5 0 63.75 Q 0 61.453 0.558 57.552 A 107.94 107.94 0 0 1 0.8 55.95 Q 1.6 50.9 3 50.9 A 0.148 0.148 0 0 1 3.054 50.915 Q 3.174 50.968 3.472 51.199 A 10.91 10.91 0 0 1 3.6 51.3 A 67.058 67.058 0 0 0 6.941 52.569 Q 11.638 54.2 14.45 54.2 A 11.292 11.292 0 0 0 17.282 53.862 A 8.481 8.481 0 0 0 20.65 52.15 Q 23.1 50.1 23.1 46.9 A 10.646 10.646 0 0 0 22.643 43.637 Q 21.529 40.177 17.698 39.244 A 13.557 13.557 0 0 0 14.5 38.9 L 5.9 39 Q 5.064 39.167 4.229 38.461 A 4.182 4.182 0 0 1 3.9 38.15 A 3.56 3.56 0 0 1 2.971 36.257 A 5 5 0 0 1 2.9 35.4 L 2.9 4.1 A 8.255 8.255 0 0 1 3.019 2.629 Q 3.481 0.092 5.735 0.003 A 4.211 4.211 0 0 1 5.9 0 Z',
		6: 'M 39.201 20.2 Q 35.201 18 29.901 18 A 10.336 10.336 0 0 0 24.99 19.107 Q 20.872 21.292 19.628 27.788 A 27.558 27.558 0 0 0 19.301 30 A 38.885 38.885 0 0 1 28.213 28.553 A 44.926 44.926 0 0 1 30.401 28.5 A 30.733 30.733 0 0 1 35.927 28.963 Q 38.919 29.511 41.25 30.708 A 13.892 13.892 0 0 1 45.251 33.75 Q 49.74 38.712 49.987 47.111 A 33.676 33.676 0 0 1 50.001 48.1 A 28.709 28.709 0 0 1 49.05 55.692 A 20.92 20.92 0 0 1 43.201 65.55 A 22.741 22.741 0 0 1 32.519 71.167 A 33.745 33.745 0 0 1 24.801 72 A 25.503 25.503 0 0 1 16.506 70.713 A 21.01 21.01 0 0 1 6.601 63.55 A 28.051 28.051 0 0 1 2.032 54.607 Q 0.779 50.624 0.299 45.803 A 63.709 63.709 0 0 1 0.001 39.5 A 65.053 65.053 0 0 1 0.976 27.88 Q 2.139 21.48 4.69 16.349 A 33.983 33.983 0 0 1 8.251 10.65 Q 16.429 0.094 29.47 0.001 A 32.556 32.556 0 0 1 29.701 0 Q 44.701 0 44.701 6.1 Q 44.701 10.079 42.411 14.549 A 29.141 29.141 0 0 1 41.901 15.5 Q 40.901 17.7 39.201 20.2 Z M 32.701 48.2 Q 32.701 45.1 30.801 43.15 Q 28.901 41.2 25.051 41.2 A 17.039 17.039 0 0 0 22.928 41.324 Q 21.849 41.46 20.968 41.745 A 6.614 6.614 0 0 0 19.201 42.6 Q 19.101 43.9 19.101 45.5 A 18.801 18.801 0 0 0 19.149 46.791 Q 19.231 47.972 19.451 49.45 A 9.503 9.503 0 0 0 20.461 52.474 A 12.436 12.436 0 0 0 21.451 54.05 A 5.735 5.735 0 0 0 22.965 55.507 Q 24.179 56.288 25.751 56.3 A 6.447 6.447 0 0 0 25.801 56.3 A 8.339 8.339 0 0 0 28.739 55.825 Q 32.701 54.339 32.701 48.2 Z',
		7: 'M 46.1 8.8 L 28.9 68.3 A 1.175 1.175 0 0 1 28.222 68.923 Q 26.447 69.777 20.198 69.884 A 110.366 110.366 0 0 1 18.3 69.9 A 191.111 191.111 0 0 1 15.914 69.886 Q 8.05 69.788 7 69 A 1.236 1.236 0 0 1 6.789 68.803 A 0.769 0.769 0 0 1 6.6 68.3 L 23.3 19.3 L 3 19.3 A 1.924 1.924 0 0 1 1.354 18.256 Q 0.267 16.539 0.053 12 A 51.051 51.051 0 0 1 0 9.6 Q 0 6.3 0.65 3.2 A 9.708 9.708 0 0 1 0.947 2.088 Q 1.619 0.1 2.9 0.1 L 37.9 0 A 6.527 6.527 0 0 1 42.784 2.175 Q 43.658 3.094 44.4 4.4 A 18.082 18.082 0 0 1 45.674 7.288 A 15.519 15.519 0 0 1 46.1 8.8 Z',
		8: 'M 49.652 57.943 A 22.173 22.173 0 0 0 51.1 49.801 Q 51.1 44.101 48.45 39.351 A 27.352 27.352 0 0 0 47.94 38.476 A 23.553 23.553 0 0 0 41.7 31.601 A 25.386 25.386 0 0 0 44.389 28.564 A 17.91 17.91 0 0 0 48.15 17.751 A 19.154 19.154 0 0 0 48.15 17.626 Q 48.15 13.488 46.356 10.115 A 17.031 17.031 0 0 0 42.15 5.051 A 19.249 19.249 0 0 0 40.242 3.648 Q 36.976 1.543 32.736 0.653 A 32.786 32.786 0 0 0 26 0.001 A 32.177 32.177 0 0 0 19.969 0.541 A 22.952 22.952 0 0 0 9.4 5.401 A 21.267 21.267 0 0 0 8.238 6.439 A 16.885 16.885 0 0 0 2.9 19.101 Q 2.9 27.401 9.7 33.301 A 38.573 38.573 0 0 0 9.186 33.705 Q 0 41.06 0 50.451 Q 0 60.101 6.75 66.051 Q 11.18 69.955 17.763 71.298 A 37.491 37.491 0 0 0 25.25 72.001 A 43.902 43.902 0 0 0 25.81 71.997 Q 29.986 71.944 33.557 71.092 A 24.04 24.04 0 0 0 44.05 65.801 A 20.172 20.172 0 0 0 49.652 57.943 Z M 19.8 48.901 A 7.789 7.789 0 0 0 20.056 50.953 A 5.739 5.739 0 0 0 21.55 53.551 Q 23.3 55.301 25.9 55.301 A 6.292 6.292 0 0 0 27.989 54.967 A 5.377 5.377 0 0 0 30.15 53.551 A 5.916 5.916 0 0 0 31.639 50.601 A 8.542 8.542 0 0 0 31.8 48.901 Q 31.8 43.501 24.9 40.001 A 11.312 11.312 0 0 0 21.817 42.673 Q 19.8 45.253 19.8 48.901 Z M 30.6 20.601 A 5.133 5.133 0 0 0 30.136 18.404 A 5.068 5.068 0 0 0 29.05 16.901 Q 27.5 15.401 25.6 15.401 A 7.699 7.699 0 0 0 23.543 15.652 Q 21.209 16.3 20.55 18.625 A 7.239 7.239 0 0 0 20.3 20.301 Q 20.3 24.45 26.167 28.174 A 30.03 30.03 0 0 0 27.2 28.801 Q 30.6 25.001 30.6 20.601 Z',
		9: 'M 8.201 53.601 A 128.587 128.587 0 0 0 11.72 54.258 Q 15.395 54.887 17.914 55.047 A 25.144 25.144 0 0 0 19.501 55.101 Q 23.301 55.101 26.351 52.701 A 8.618 8.618 0 0 0 29.022 49.032 Q 29.554 47.698 29.796 46.058 A 17.639 17.639 0 0 0 29.901 45.201 Q 25.268 46.499 22.352 46.594 A 13.828 13.828 0 0 1 21.901 46.601 A 30.317 30.317 0 0 1 15.527 45.972 Q 9.531 44.682 5.701 40.751 A 19.001 19.001 0 0 1 1.092 32.62 Q 0.001 28.855 0.001 24.151 A 28.758 28.758 0 0 1 1.041 16.228 A 22.088 22.088 0 0 1 6.551 6.701 A 21.666 21.666 0 0 1 17.83 0.66 A 32.059 32.059 0 0 1 24.501 0.001 A 26.074 26.074 0 0 1 32.593 1.198 A 20.86 20.86 0 0 1 42.451 8.001 Q 47.344 13.978 48.582 24.196 A 61.694 61.694 0 0 1 49.001 31.601 Q 49.001 44.169 46.114 52.978 A 35.185 35.185 0 0 1 42.051 61.551 A 22.362 22.362 0 0 1 25.911 71.693 A 31.799 31.799 0 0 1 21.401 72.001 Q 8.808 72.001 5.544 68.874 A 3.45 3.45 0 0 1 4.401 66.301 A 19.836 19.836 0 0 1 4.518 64.246 Q 4.759 61.949 5.494 58.89 A 67.327 67.327 0 0 1 5.601 58.451 A 28.231 28.231 0 0 1 6.039 56.865 Q 6.745 54.592 7.517 53.902 A 1.028 1.028 0 0 1 8.201 53.601 Z M 24.301 18.001 A 7.988 7.988 0 0 0 22.23 18.255 A 5.595 5.595 0 0 0 19.351 20.051 A 7.18 7.18 0 0 0 17.759 23.481 A 10.033 10.033 0 0 0 17.601 25.301 A 8.096 8.096 0 0 0 17.927 27.653 A 6.327 6.327 0 0 0 19.651 30.451 A 7.001 7.001 0 0 0 23.742 32.333 A 9.533 9.533 0 0 0 24.901 32.401 A 11.955 11.955 0 0 0 27.089 32.213 Q 28.836 31.887 30.101 31.001 Q 30.101 25.601 29.305 22.558 A 10.891 10.891 0 0 0 28.801 21.051 A 5.725 5.725 0 0 0 27.805 19.445 Q 26.503 18.001 24.301 18.001 Z'
	};

	type PathSegmentCharacter = 'M' | 'A' | 'Z' | 'L' | 'Q' | 'C';

	const isPathSegmentCharacter = (
		str: string | PathSegmentCharacter
	): str is PathSegmentCharacter => ['M', 'A', 'Z', 'L', 'Q', 'C'].includes(str);

	const parsePathSegments = (pathString: string): (PathSegment | PathSegmentCharacter[])[] => {
		const pathSegments: (PathSegment | PathSegmentCharacter[])[] = [];
		pathString
			.split(' ')
			.map((elem) => elem.trim())
			.forEach((elem) => {
				if (isPathSegmentCharacter(elem)) {
					pathSegments.push([elem]);
				} else {
					const num = Number.parseFloat(elem);
					(pathSegments[pathSegments.length - 1] as PathSegment).push(num);
				}
			});
		return pathSegments;
	};

	const getPointsFromPathSegment = (segment: PathSegment): Point | null => {
		if (isLinePathSegment(segment)) {
			return { x: segment[1], y: segment[2] };
		}
		if (isMovePathSegment(segment)) {
			return { x: segment[1], y: segment[2] };
		}
		if (isArcPathSegment(segment)) {
			return { x: segment[6], y: segment[7] };
		}
		if (isCubicBezierPathSegment(segment)) {
			return { x: segment[5], y: segment[6] };
		}
		if (isQuadraticBezierPathSegment(segment)) {
			return { x: segment[3], y: segment[4] };
		}
		return null;
	};

	const centeredOn = (
		point: Point,
		text: PathSegment[]
	): { path: PathSegment[]; center: Point } => {
		const points: Point[] = text
			.map((segment) => getPointsFromPathSegment(segment))
			.filter((point) => point !== null) as Point[];

		const xValues = points.map((point) => point.x);
		const yValues = points.map((point) => point.y);

		const minX = Math.min(...xValues);
		const maxX = Math.max(...xValues);
		const minY = Math.min(...yValues);
		const maxY = Math.max(...yValues);

		const center = { x: (minX + maxX) / 2, y: (minY + maxY) / 2 };

		console.debug('min max', minX, maxX, minY, maxY);

		const offsetX = point.x - (maxX - minX) / 2;
		const offsetY = point.y - (maxY - minY) / 2;

		const offsetText = text.map((segment) => {
			if (segment[0] === 'A') {
				return segment.map((elem, i) => {
					if (i === 6) {
						return (elem as number) + offsetX;
					}
					if (i === 7) {
						return (elem as number) + offsetY;
					}
					return elem;
				});
			}
			// if (segment[0] === 'Q') {
			// 	return segment.map((elem, i) => {
			// 		if (i === 3) {
			// 			return (elem as number) + offsetX;
			// 		}
			// 		if (i === 4) {
			// 			return (elem as number) + offsetY;
			// 		}
			// 		return elem;
			// 	});
			// }
			// if (segment[0] === 'C') {
			// 	return segment.map((elem, i) => {
			// 		if (i === 5) {
			// 			return (elem as number) + offsetX;
			// 		}
			// 		if (i === 6) {
			// 			return (elem as number) + offsetY;
			// 		}
			// 		return elem;
			// 	});
			// }

			return segment.map((elem, i) => {
				if (typeof elem === 'number') {
					if (i > 0 && i % 2 === 1) {
						return elem + offsetX;
					}
					if (i > 0 && i % 2 === 0) {
						return elem + offsetY;
					}
				}
				return elem;
			});
		});
		return { path: offsetText as PathSegment[], center };
	};

	const testSegs: PathSegment[] = [
		['M', 0, 0],
		['L', 100, 0],
		['L', 100, 100],
		['L', 0, 100],
		['L', 0, 0],
		['Z']
	];

	console.debug('test', testSegs, 'transformed', centeredOn({ x: 10, y: 10 }, testSegs));

	const getLabelPath = (value: number, r: number) => {
		const labelTextPathSegments = numberPathSegments[value];
		const labelOutlinePathSegments: PathSegment[] = [
			['M', 50, 0],
			['L', 100 - r, 0],
			['Q', 100, 0, 100, r],
			['L', 100, 100 - r],
			['Q', 100, 100, 100 - r, 100],
			['L', r, 100],
			['Q', 0, 100, 0, 100 - r],
			['L', 0, r],
			['Q', 0, 0, r, 0],
			['L', 50, 0],
			['Z']
		];

		const stemWidth = 20;
		const stemLength = 50;

		const stemSegments: PathSegment[] = [
			['M', 50 - stemWidth / 2, 0],
			['L', 50 - stemWidth / 2, -stemLength],
			['L', 50 + stemWidth / 2, -stemLength],
			['L', 50 + stemWidth / 2, 0],
			['L', 50 - stemWidth / 2, 0],
			['Z']
		];

		const { path } = centeredOn({ x: 50, y: 50 }, labelTextPathSegments);

		return {
			path: svgPathStringFromSegments([...stemSegments, ...labelOutlinePathSegments, ...path])
		};
	};

	const getPathString = (value: number) =>
		`${value}`.split('').map((val) => numberPathStrings[val]);

	let { path } = getLabelPath(value, 40);
</script>

<g>
	<!-- <rect x="0" y="0" width="100" height="100" rx={20} fill="green" /> -->
	<g fill="red">
		<path d={path} fill-rule="evenodd" />
	</g>
</g>

<style>
	.small {
		line-height: 20px;
		font: san-serif;
		font-weight: 900;
	}
</style>
