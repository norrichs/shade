import { generateTempId } from '$lib/id-handler';
import { defaultCrossSection, secondEdgeCurveConfig } from '../curve-definitions';
import {
	computeTrianglePolygonMap,
	convertXYZtoVertices,
	generatePolygonConfigs
} from '../generate-polyhedra';
import type { PolyhedronConfig, VertexIndex, CurveIndex } from '../types';

// notes about geodesicXYZString:
// the shape described is a 3v geodesic sphere.  Also referred to as a geodesic sphere with frequency of 3.  It is composed of 180 triangles.
// The string encodes the 3 dimensional coordinates of the points forming the triangles
// Each line of the string represencts a single point, with x, y, z coordinates separated by spaces
// Each point is nearly exactly equidistant from the center of the sphere, which is at (0, 0, 0)
// Each point represents a vertex of 5 or 6 triangles

const geodesicXYZString = `-1.80056059 -1.30818379 1.11280763
0.68775296 2.11668587 1.11280763
-1.80056059 1.30818379 1.11280763
0.68775296 -2.11668587 1.11280763
2.22561526 0 1.11280763
-2.08075213 0.45655429 1.28597558
-1.35457265 0.98415458 1.84072733
-2.08075213 -0.45655429 1.28597558
-1.35457265 -0.98415458 1.84072733
0 -0 2.48831344
-0.72617954 0.52760029 2.32077694
-0.72617954 -0.52760029 2.32077694
-1.5186336 0.00636372 1.97114587
-0.68775296 -2.11668587 -1.11280763
-0.51740068 -1.59239554 -1.84072733
0.20877883 -2.11999583 -1.28597558
1.80056059 -1.30818379 -1.11280763
1.07719672 -1.83782983 -1.28597558
1.35457265 -0.98415458 -1.84072733
0.72617954 -0.52760029 -2.32077694
-0.27737591 -0.85367525 -2.32077694
0 0 -2.48831344
0.46323133 -1.44627285 -1.97114587
2.08075213 -0.45655429 -1.28597558
1.80056059 1.30818379 -1.11280763
2.08075213 0.45655429 -1.28597558
1.35457265 0.98415458 -1.84072733
0.72617954 0.52760029 -2.32077694
1.5186336 -0.00636372 -1.97114587
1.07719672 1.83782983 -1.28597558
-0.68775296 2.11668587 -1.11280763
0.20877883 2.11999583 -1.28597558
-0.51740068 1.59239554 -1.84072733
-0.27737591 0.85367525 -2.32077694
0.47533584 1.4423399 -1.97114587
1.24358022 2.11999583 0.38836828
0.24002481 2.44607091 0.38836828
1.63194847 1.83782983 -0.38836828
-0.24002481 2.44607091 -0.38836828
0.76124561 2.3246367 -0.45636994
-0.20877883 2.11999583 1.28597558
-1.24358022 2.11999583 -0.38836828
-1.07719672 1.83782983 1.28597558
-1.63194847 1.83782983 0.38836828
-0.74383533 2.32811952 0.46719652
0.24002481 -2.44607091 0.38836828
1.24358022 -2.11999583 0.38836828
-0.24002481 -2.44607091 -0.38836828
1.63194847 -1.83782983 -0.38836828
0.75052655 -2.32811952 -0.45636994
1.95171976 0.85367525 1.28597558
2.40052342 0.52760029 0.38836828
2.25217986 0.98415458 -0.38836828
1.41500795 1.59239554 1.28597558
1.98431551 1.42685795 0.46719652
1.41500795 -1.59239554 1.28597558
2.25217986 -0.98415458 -0.38836828
1.95171976 -0.85367525 1.28597558
2.40052342 -0.52760029 0.38836828
1.97020984 -1.44627285 0.46719652
-2.25217986 0.98415458 0.38836828
-1.41500795 1.59239554 -1.28597558
-1.95171976 0.85367525 -1.28597558
-2.22561526 -0 -1.11280763
-2.40052342 0.52760029 -0.38836828
-1.97562313 1.4423399 -0.45636994
-2.40052342 -0.52760029 -0.38836828
-2.25217986 -0.98415458 0.38836828
-2.444031 0.01199905 0.46719652
-1.63194847 -1.83782983 0.38836828
-1.95171976 -0.85367525 -1.28597558
-1.24358022 -2.11999583 -0.38836828
-1.41500795 -1.59239554 -1.28597558
-1.98224783 -1.4332217 -0.45636994
-1.67434382 0 -1.84072733
-0.89760727 0 -2.32077694
-1.22485983 0.89777875 -1.97114587
-1.23234081 -0.88748205 -1.97114587
-1.07719672 -1.83782983 1.28597558
-0.20877883 -2.11999583 1.28597558
-0.7666589 -2.32070374 0.46719652
0.51740068 -1.59239554 1.84072733
0.27737591 -0.85367525 2.32077694
-0.47533584 -1.4423399 1.97114587
1.67434382 -0 1.84072733
0.89760727 0 2.32077694
1.22485983 -0.89777875 1.97114587
0.51740068 1.59239554 1.84072733
0.27737591 0.85367525 2.32077694
1.23234081 0.88748205 1.97114587
-0.46323133 1.44627285 1.97114587
2.4460988 -0.00563533 -0.45636994`;

const vertices = convertXYZtoVertices(geodesicXYZString, 50, false);

// 16 levels: 1, 5, 5, 5, 10, 5, 5, 10, 10, 5, 5, 10, 5, 5, 5, 1
// 180 triangles, auto-computed from vertex adjacency and 5-fold rotational symmetry
const polygonMap = computeTrianglePolygonMap({ vertices });

const geodesic: PolyhedronConfig<undefined, VertexIndex, CurveIndex, CurveIndex> = {
	name: '3v Geodesic Sphere',
	id: generateTempId('cfg'),
	polygons: generatePolygonConfigs({ vertices, polygonMap }),
	crossSectionCurves: [defaultCrossSection],
	edgeCurves: [secondEdgeCurveConfig],
	vertices,
	transform: 'inherit'
};

export default geodesic;
